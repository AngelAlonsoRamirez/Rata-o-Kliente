<html><head>
  <meta charset="UTF-8">

<title>Crear Chat</title>
  <script src="https://use.fontawesome.com/e63bef178e.js"></script>
  <script src='file:///android_asset/app.js'></script>
  <script src='sticker.js'></script>
  <script src='rata-on.js'></script>
  <script src='kliente-on.js'></script>
  <link rel="stylesheet" href="chat.css">
  
    <script>
      var x=Math.ceil(Math.random()*7736);
      var usuario = app.GetUser();

    function nick() {
      var x=Math.ceil(Math.random()*7736);
      var usuario = "Nick" + x

        document.getElementById("nick").value = usuario;
        var usuario = document.getElementById("nick").value;
        setTimeout('bot()',1000);
    }

</script>

</head>

<body>
  <div class="chat-container">
  <ul class="chat-feed">

  </ul>
<div id="arriba">
      <textarea style="height: 50px; width: 100%; font-size: 16px; background-color: #f6ecbf; font-family: 'Open Sans', sans-serif; border: none; overflow: auto; outline: none; padding-top: 5%; padding-left: 55px;" placeholder="EscrÃ­be un mensaje..." id='message'></textarea>

<input type="image" id="logos" src="Img/casa.png" onclick="location.href='index.html'" name="submit" width="35" height="35"/>
<input type="image" id="logos" src="Img/rata.png" onclick="rata()" name="submit" width="35" height="35"/>
<input type="image" id="logos" src="Img/kliente.png" onclick="kliente()" name="submit" width="35" height="35"/>


<div class="seleccion" id="memes" Onclick="">
  <div class="options">
  <input type="radio" id="pictograma" value="2">
  <form name=imagenes><br><br>
<label><input type="Radio" name="pictograma" OnClick='imagen1()'><img src="Img/img1.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen2()'><img src="Img/img2.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen3()'><img src="Img/img3.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen4()'><img src="Img/img4.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen5()'><img src="Img/img5.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen6()'><img src="Img/img6.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen7()'><img src="Img/img7.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen8()'><img src="Img/img8.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen9()'><img src="Img/img9.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen10()'><img src="Img/img10.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen11()'><img src="Img/img11.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen12()'><img src="Img/img12.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen13()'><img src="Img/img13.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen14()'><img src="Img/img14.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen15()'><img src="Img/img15.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen16()'><img src="Img/img16.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen17()'><img src="Img/img17.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen18()'><img src="Img/img18.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen19()'><img src="Img/img19.webp" border="0"  width="50" height="50"/></label>
<label><input type="Radio" name="pictograma" OnClick='imagen20()'><img src="Img/img20.webp" border="0"  width="50" height="50"/></label>

</div></div>



<input type="image" id="logos" src="Img/shared.png" onclick="shared()" name="submit" width="35" height="35"/>


</div>
<div id="todo">
<center><textarea style="background: #f6ecbf; border-radius: 15px; border: 2px solid #F1DB79;" placeholder="Escribe aquÃ­ un nick..." id="nick" rows="2" cols="30"></textarea></center>
</div>

<script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
  
    <script>
function _0x1d14(_0x1447a1,_0x5b9ff2){var _0x3df98c=_0x3df9();return _0x1d14=function(_0x1d14b0,_0x4300bd){_0x1d14b0=_0x1d14b0-0xc0;var _0x21190c=_0x3df98c[_0x1d14b0];return _0x21190c;},_0x1d14(_0x1447a1,_0x5b9ff2);}var _0x3d4e7d=_0x1d14;(function(_0x2056dc,_0x24a4b0){var _0x4afd56=_0x1d14,_0x9768df=_0x2056dc();while(!![]){try{var _0x1c4c2a=-parseInt(_0x4afd56(0xca))/0x1*(-parseInt(_0x4afd56(0xce))/0x2)+parseInt(_0x4afd56(0xc1))/0x3+parseInt(_0x4afd56(0xcc))/0x4+-parseInt(_0x4afd56(0xcd))/0x5+parseInt(_0x4afd56(0xc3))/0x6+parseInt(_0x4afd56(0xcb))/0x7*(-parseInt(_0x4afd56(0xc0))/0x8)+-parseInt(_0x4afd56(0xc5))/0x9*(-parseInt(_0x4afd56(0xd0))/0xa);if(_0x1c4c2a===_0x24a4b0)break;else _0x9768df['push'](_0x9768df['shift']());}catch(_0x3b5236){_0x9768df['push'](_0x9768df['shift']());}}}(_0x3df9,0x98cb6));var config={'apiKey':_0x3d4e7d(0xc2),'authDomain':_0x3d4e7d(0xcf),'databaseURL':_0x3d4e7d(0xc6),'projectId':'rata-o-kliente-chat','storageBucket':_0x3d4e7d(0xc9),'messagingSenderId':_0x3d4e7d(0xc4),'appId':_0x3d4e7d(0xc7)};firebase[_0x3d4e7d(0xc8)](config);function _0x3df9(){var _0x431a0e=['4930814kQLdjE','3161688cVEneT','4581165VEAyLP','5142lhmDsp','rata-o-kliente-chat.firebaseapp.com','11608530sCrwQn','8qcMdeH','320235ebVVIi','AIzaSyChSGzWz3Isu6hvYh329SVDPcLuDi1kkE4','467448zWZXtk','130260375848','9HrDXvq','https://rata-o-kliente-chat.firebaseio.com','1:130260375848:web:073ed525bed8d999','initializeApp','rata-o-kliente-chat.appspot.com','43QNzwZg'];_0x3df9=function(){return _0x431a0e;};return _0x3df9();}
/*
    var config = {
        apiKey: "",
        authDomain: "",
        databaseURL: "",
        projectId: "",
        storageBucket: "",
        messagingSenderId: "",
        appId: ""
        };
        
    firebase.initializeApp(config);
  */

const db = firebase.database();
const chatForm = document.querySelector('form');
const textBox = document.querySelector('textarea');
const chats = document.querySelector('ul');

var d = new Date();
var ramdom = Math.floor(Math.random() * 100*5);
var codigo = location.hash
codigo = codigo.replace(/#/gi,"");



if (codigo == null) {
    app.Alert("El codigo no es valido.", "ERROR","", 180 );
    location.href = "index.html"
    }

if (codigo == '') {
    app.Alert("El codigo no es valido.", "ERROR","", 180 );
    location.href = "index.html"
    }
    
var chat = 'Salas/Temporal/' + codigo
const sessionId = document.getElementById("nick").value;

const chatsRef = db.ref('/' + chat);
  const mensajeId = Date.now();
  var d = new Date();
    var f = new Date();
  var tiempo = d.getHours() + ":" + d.getMinutes()
  var fecha = d.getHours() + ":" + d.getMinutes()


function bot() {
    var usuario = document.getElementById("nick").value;

    var aaa="Bot"
    var texto ="El usuario " + usuario + " se uniÃ³ al chat."
    db.ref(chat + '/' + mensajeId).set({
        id: aaa,
        mensaje: texto
        });
    }

function handleSubmit(e) {
  e.preventDefault();
  
  if (!textBox.value) {
    return;
  }
    const mensajeId = Date.now();
  var d = new Date();
  var tiempo = d.getHours() + ":" + d.getMinutes()


    textBox.value = textBox.value.replace(/puta/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/negrata/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/puto/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/ostia/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/hostia/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/maricon/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/gilipolla/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/jilipolla/gi,'ğŸ¤¬');
    textBox.value = textBox.value.replace(/joder/gi,'ğŸ¤¬');
    

    textBox.value = textBox.value.replace(/ /gi,'!ğŸ±!');
    textBox.value = textBox.value.replace(/a/gi,'!ğŸ˜€!');
    textBox.value = textBox.value.replace(/b/gi,'!ğŸ˜ƒ!');
    textBox.value = textBox.value.replace(/c/gi,'!ğŸ˜„!');
    textBox.value = textBox.value.replace(/d/gi,'!ğŸ˜!');
    textBox.value = textBox.value.replace(/e/gi,'!ğŸ˜†!');
    textBox.value = textBox.value.replace(/f/gi,'!ğŸ˜…!');
    textBox.value = textBox.value.replace(/g/gi,'!ğŸ˜‚!');
    textBox.value = textBox.value.replace(/h/gi,'!ğŸ˜!');
    textBox.value = textBox.value.replace(/i/gi,'!ğŸ˜!');
    textBox.value = textBox.value.replace(/j/gi,'!ğŸ˜œ!');
    textBox.value = textBox.value.replace(/k/gi,'!ğŸ˜!');
    textBox.value = textBox.value.replace(/l/gi,'!ğŸ˜›!');
    textBox.value = textBox.value.replace(/m/gi,'!ğŸ˜‹!');
    textBox.value = textBox.value.replace(/n/gi,'!ğŸ˜«!');
    textBox.value = textBox.value.replace(/Ã±/gi,'!ğŸ˜­!');
    textBox.value = textBox.value.replace(/o/gi,'!ğŸ˜ !');
    textBox.value = textBox.value.replace(/p/gi,'!ğŸ˜¡!');
    textBox.value = textBox.value.replace(/q/gi,'!ğŸ˜³!');
    textBox.value = textBox.value.replace(/r/gi,'!ğŸ˜±!');
    textBox.value = textBox.value.replace(/s/gi,'!ğŸ˜¨!');
    textBox.value = textBox.value.replace(/t/gi,'!ğŸ˜°!');
    textBox.value = textBox.value.replace(/u/gi,'!ğŸ‘¿!');
    textBox.value = textBox.value.replace(/v/gi,'!ğŸ˜ˆ!');
    textBox.value = textBox.value.replace(/w/gi,'!ğŸ˜¹!');
    textBox.value = textBox.value.replace(/x/gi,'!ğŸŒ!');
    textBox.value = textBox.value.replace(/y/gi,'!ğŸŒš!');
    textBox.value = textBox.value.replace(/z/gi,'!ğŸ¶!');

textBox.value = textBox.value.replace(/</gi,"");
textBox.value = textBox.value.replace(/>/gi,"");
var usuario = document.getElementById("nick").value;

  db.ref(chat + '/' + mensajeId).set({
    id: sessionId,
    mensaje: "<b>" + usuario + "</b> <br><i>" + tiempo + '</i><br>' + textBox.value
  });
  
  textBox.value = '';
}

chatsRef.on('child_added', handleChildAdded);

function handleChildAdded(data) {
  const mensajeData = data.val();
  const li = document.createElement('li');
  
  li.innerHTML = mensajeData.mensaje;
  li.innerHTML = li.innerHTML.replace(/!ğŸ±!/gi,' ');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜€!/gi,'a');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜ƒ!/gi,'b');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜„!/gi,'c');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜!/gi,'d');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜†!/gi,'e');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜…!/gi,'f');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜‚!/gi,'g');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜!/gi,'h');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜!/gi,'i');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜œ!/gi,'j');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜!/gi,'k');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜›!/gi,'l');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜‹!/gi,'m');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜«!/gi,'n');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜­!/gi,'Ã±');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜ !/gi,'o');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜¡!/gi,'p');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜³!/gi,'q');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜±!/gi,'r');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜¨!/gi,'s');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜°!/gi,'t');
  li.innerHTML = li.innerHTML.replace(/!ğŸ‘¿!/gi,'u');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜ˆ!/gi,'v');
  li.innerHTML = li.innerHTML.replace(/!ğŸ˜¹!/gi,'w');
  li.innerHTML = li.innerHTML.replace(/!ğŸŒ!/gi,'x');
  li.innerHTML = li.innerHTML.replace(/!ğŸŒš!/gi,'y');
  li.innerHTML = li.innerHTML.replace(/!ğŸ¶!/gi,'z');

  if (mensajeData.id !== sessionId) {
  li.classList.add('other');
  }
  
  chats.appendChild(li);
  chats.scrollTop = chats.scrollHeight;
}

textBox.addEventListener('keydown', handleKeyDown);

function handleKeyDown(e) {
  if (e.which == 13) {
    handleSubmit(e);
  }
}

function shared() {
      var mensaje="Â¿Te atreves a jugar conmigo a Rata o Kliente?\nUnete a mi sala para jugar ğŸ˜ˆğŸ˜ˆğŸ˜ˆ\n" + codigo + "\n\nhttps://github.com/AngelAlonsoRamirez/Rata-o-Kliente/raw/main/android.apk"
          app.OpenUrl( "https://api.whatsapp.com/send?text=" + mensaje);

    }
</script>
<body onload="nick()">
</html>